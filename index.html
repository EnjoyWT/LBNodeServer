<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H5 Page 1</title>
</head>
<body>
  <button id="queryButton">Query Data</button>
  <div id="dataDisplay"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
  <script>
    const socket = io('http://192.168.11.12:3000');

    const identifier = 'AndroidId'; 

    // 主动查询数据
    document.getElementById('queryButton').addEventListener('click', () => {
      socket.emit('queryData', identifier); // 查询时需要带有标识符
    });

    //服务器主动推送或者前端主动查询时返回数据
    socket.on('serverUpdateData', (data) => {
      console.log('Received data from server:', data);
      // 在此处理从服务器接收到的数据
      updateDataDisplay(data);
    });

    //连接后需要调用这个传递标识符,服务器一个标识只会记录一个socket实例.
    socket.emit("setIdentifier",identifier)

  
    function updateDataDisplay(data) {
      const dataDisplay = document.getElementById('dataDisplay');
      dataDisplay.textContent = JSON.stringify(data); 
    }
  </script>
</body>
</html>
